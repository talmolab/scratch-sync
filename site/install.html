<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Installation - scratch-sync</title>
  <meta name="description" content="How to install scratch-sync on macOS, Linux, and Windows.">
  <link rel="stylesheet" href="assets/style.css">
</head>
<body>
  <nav>
    <a href="/">Home</a>
    <a href="/install.html">Installation</a>
    <a href="/cli.html">CLI Reference</a>
    <a href="https://github.com/talmolab/scratch-sync">GitHub</a>
  </nav>

  <h1>Installation</h1>
  <p class="tagline">Get scratch-sync running on your machines</p>

  <h2>Prerequisites</h2>

  <p>Before installing scratch-sync, make sure you have:</p>

  <ul>
    <li><strong><a href="https://tailscale.com/download">Tailscale</a></strong> installed and connected on all machines you want to sync</li>
    <li>All machines on the <strong>same Tailnet</strong></li>
  </ul>

  <h2>Quick Install</h2>

  <div class="tabs">
    <button class="tab active" onclick="showTab('unix')">macOS / Linux</button>
    <button class="tab" onclick="showTab('windows')">Windows</button>
  </div>

  <div id="unix" class="tab-content active">
    <div class="code-block">
      <pre><code>curl -LsSf https://scratch.tlab.sh/install.sh | sh</code></pre>
      <button class="copy-btn" onclick="copyCode(this, 'curl -LsSf https://scratch.tlab.sh/install.sh | sh')">Copy</button>
    </div>
  </div>

  <div id="windows" class="tab-content">
    <div class="code-block">
      <pre><code>iwr -useb https://scratch.tlab.sh/install.ps1 | iex</code></pre>
      <button class="copy-btn" onclick="copyCode(this, 'iwr -useb https://scratch.tlab.sh/install.ps1 | iex')">Copy</button>
    </div>
  </div>

  <h2>What the Installer Does</h2>

  <h3>macOS / Linux</h3>

  <p>The install script performs these steps:</p>

  <ol>
    <li><strong>Detects your platform</strong> (macOS or Linux, Intel or ARM)</li>
    <li><strong>Downloads Syncthing</strong> from the official GitHub releases</li>
    <li><strong>Installs the binary</strong> to <code>~/.local/bin/syncthing</code></li>
    <li><strong>Sets up auto-start:</strong>
      <ul>
        <li>macOS: Creates a LaunchAgent at <code>~/Library/LaunchAgents/com.syncthing.syncthing.plist</code></li>
        <li>Linux: Creates a systemd user service at <code>~/.config/systemd/user/syncthing.service</code></li>
      </ul>
    </li>
    <li><strong>Starts Syncthing</strong> in the background</li>
  </ol>

  <h3>Windows</h3>

  <p>The PowerShell installer:</p>

  <ol>
    <li><strong>Detects your architecture</strong> (x64, ARM64, or x86)</li>
    <li><strong>Downloads Syncthing</strong> from the official GitHub releases</li>
    <li><strong>Installs the binary</strong> to <code>%LOCALAPPDATA%\Programs\syncthing</code></li>
    <li><strong>Creates a Scheduled Task</strong> to run Syncthing at login</li>
    <li><strong>Optionally adds to PATH</strong> (you'll be prompted)</li>
    <li><strong>Starts Syncthing</strong> immediately</li>
  </ol>

  <h2>Installation Options</h2>

  <h3>macOS / Linux Options</h3>

  <table>
    <tr>
      <th>Option</th>
      <th>Description</th>
    </tr>
    <tr>
      <td><code>--uninstall</code></td>
      <td>Remove Syncthing and the auto-start service</td>
    </tr>
    <tr>
      <td><code>--upgrade</code></td>
      <td>Upgrade to the latest Syncthing version</td>
    </tr>
    <tr>
      <td><code>-y, --yes</code></td>
      <td>Skip confirmation prompts (for scripting)</td>
    </tr>
  </table>

  <p>Environment variables:</p>

  <table>
    <tr>
      <th>Variable</th>
      <th>Default</th>
      <th>Description</th>
    </tr>
    <tr>
      <td><code>INSTALL_DIR</code></td>
      <td><code>~/.local/bin</code></td>
      <td>Where to install the binary</td>
    </tr>
    <tr>
      <td><code>NO_SERVICE</code></td>
      <td><code>0</code></td>
      <td>Set to 1 to skip service setup</td>
    </tr>
    <tr>
      <td><code>SYNCTHING_VERSION</code></td>
      <td>Latest</td>
      <td>Specific version to install</td>
    </tr>
  </table>

  <p>Examples:</p>

  <div class="code-block">
    <pre><code># Uninstall
curl -LsSf https://scratch.tlab.sh/install.sh | sh -s -- --uninstall

# Upgrade to latest
curl -LsSf https://scratch.tlab.sh/install.sh | sh -s -- --upgrade

# Install without prompts
curl -LsSf https://scratch.tlab.sh/install.sh | sh -s -- -y

# Custom install directory
INSTALL_DIR=/opt/bin curl -LsSf https://scratch.tlab.sh/install.sh | sh</code></pre>
  </div>

  <h3>Windows Options</h3>

  <table>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
    <tr>
      <td><code>-Uninstall</code></td>
      <td>Remove Syncthing and scheduled task</td>
    </tr>
    <tr>
      <td><code>-NoService</code></td>
      <td>Skip scheduled task setup</td>
    </tr>
    <tr>
      <td><code>-SyncthingVersion</code></td>
      <td>Install a specific version</td>
    </tr>
    <tr>
      <td><code>-InstallDir</code></td>
      <td>Custom installation directory</td>
    </tr>
  </table>

  <p>Examples:</p>

  <div class="code-block">
    <pre><code># Download and run with options
Invoke-WebRequest -Uri https://scratch.tlab.sh/install.ps1 -OutFile install.ps1
.\install.ps1 -Uninstall
.\install.ps1 -NoService</code></pre>
  </div>

  <h2>Installing the CLI</h2>

  <p>The scratch-sync CLI is a Python package that helps you manage synced folders. Install it with:</p>

  <div class="code-block">
    <pre><code># Using uvx (recommended - no install needed)
uvx scratch-sync --help

# Or install with pip
pip install scratch-sync

# Or with uv
uv pip install scratch-sync</code></pre>
  </div>

  <div class="note">
    <p><strong>Note:</strong> <code>uvx</code> runs the CLI without installing it globally. This is the recommended approach as it always uses the latest version.</p>
  </div>

  <h2>Verifying Installation</h2>

  <p>After installation, verify everything is working:</p>

  <div class="code-block">
    <pre><code># Check Syncthing is installed
syncthing --version

# Check it's running (opens web UI)
open http://127.0.0.1:8384  # macOS
xdg-open http://127.0.0.1:8384  # Linux
start http://127.0.0.1:8384  # Windows

# Get your device ID
syncthing cli show system | grep myID</code></pre>
  </div>

  <h2>Troubleshooting</h2>

  <h3>Syncthing not in PATH</h3>

  <p>If <code>syncthing</code> command is not found, add the install directory to your PATH:</p>

  <div class="code-block">
    <pre><code># Add to ~/.bashrc or ~/.zshrc
export PATH="$HOME/.local/bin:$PATH"</code></pre>
  </div>

  <h3>Service not starting (Linux)</h3>

  <div class="code-block">
    <pre><code># Check service status
systemctl --user status syncthing

# View logs
journalctl --user -u syncthing -f

# Manually start
systemctl --user start syncthing</code></pre>
  </div>

  <h3>Service not starting (macOS)</h3>

  <div class="code-block">
    <pre><code># Check if loaded
launchctl list | grep syncthing

# View logs
tail -f ~/Library/Logs/syncthing.log

# Manually load
launchctl load ~/Library/LaunchAgents/com.syncthing.syncthing.plist</code></pre>
  </div>

  <footer>
    <a href="https://github.com/talmolab/scratch-sync">GitHub</a>
    <a href="/">Home</a>
    <a href="/cli.html">CLI Reference</a>
    <a href="https://pypi.org/project/scratch-sync/">PyPI</a>
  </footer>

  <script>
    function showTab(id) {
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      document.querySelector(`[onclick="showTab('${id}')"]`).classList.add('active');
      document.getElementById(id).classList.add('active');
    }

    function copyCode(btn, text) {
      navigator.clipboard.writeText(text).then(() => {
        btn.textContent = 'Copied!';
        btn.classList.add('copied');
        setTimeout(() => {
          btn.textContent = 'Copy';
          btn.classList.remove('copied');
        }, 2000);
      });
    }

    // Auto-detect OS and select appropriate tab
    (function() {
      const platform = navigator.platform.toLowerCase();
      const userAgent = navigator.userAgent.toLowerCase();
      if (platform.includes('win') || userAgent.includes('windows')) {
        showTab('windows');
      }
      // macOS and Linux default to 'unix' tab (already active)
    })();
  </script>
</body>
</html>
